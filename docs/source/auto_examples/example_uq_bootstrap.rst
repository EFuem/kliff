
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/example_uq_bootstrap.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_example_uq_bootstrap.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_example_uq_bootstrap.py:


.. _tut_bootstrap:

Bootstrapping
=============

In this example, we demonstrate how to perform uncertainty quantification (UQ) using
bootstrap method. We use a Stillinger-Weber (SW) potential for silicon that is archived
in OpenKIM_.

For simplicity, we only set the energy-scaling parameters, i.e., ``A`` and ``lambda`` as
the tunable parameters. These parameters will be calibrated to energies and forces of a
small dataset, consisting of 4 compressed and stretched configurations of diamond silicon
structure.

.. GENERATED FROM PYTHON SOURCE LINES 19-26

To start, let's first install the SW model::

   $ kim-api-collections-management install user SW_StillingerWeber_1985_Si__MO_405512056662_006

.. seealso::
   This installs the model and its driver into the ``User Collection``. See
   :ref:`install_model` for more information about installing KIM models.

.. GENERATED FROM PYTHON SOURCE LINES 26-38

.. code-block:: default



    import matplotlib.pyplot as plt
    import numpy as np

    from kliff.calculators import Calculator
    from kliff.dataset import Dataset
    from kliff.loss import Loss
    from kliff.models import KIMModel
    from kliff.uq.bootstrap import BootstrapEmpiricalModel
    from kliff.utils import download_dataset








.. GENERATED FROM PYTHON SOURCE LINES 39-42

Before running bootstrap, we need to define a loss function and train the model. More
detail information about this step can be found in :ref:`tut_kim_sw` and
:ref:`tut_params_transform`.

.. GENERATED FROM PYTHON SOURCE LINES 42-72

.. code-block:: default


    # Create the model
    model = KIMModel(model_name="SW_StillingerWeber_1985_Si__MO_405512056662_006")

    # Set the tunable parameters and the initial guess
    opt_params = {"A": [["default"]], "lambda": [["default"]]}

    model.set_opt_params(**opt_params)
    model.echo_opt_params()

    # Get the dataset
    dataset_path = download_dataset(dataset_name="Si_training_set_4_configs")
    # Read the dataset
    tset = Dataset(dataset_path)
    configs = tset.get_configs()

    # Create calculator
    calc = Calculator(model)
    # Only use the forces data
    ca = calc.create(configs, use_energy=False, use_forces=True)

    # Instantiate the loss function
    residual_data = {"normalize_by_natoms": False}
    loss = Loss(calc, residual_data=residual_data)

    # Train the model
    min_kwargs = dict(method="lm")  # Optimizer setting
    loss.minimize(**min_kwargs)
    model.echo_opt_params()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    #================================================================================
    # Model parameters that are optimized.
    # Note that the parameters are in the transformed space if 
    # `params_transform` is provided when instantiating the model.
    #================================================================================

    A 1
      1.5284847919791400e+01 

    lambda 1
      4.5532200000000003e+01 


    2023-03-28 09:29:12.199 | INFO     | kliff.dataset.dataset:_read:398 - 4 configurations read from /home/yonatank/modules/kliff/examples/Si_training_set_4_configs
    2023-03-28 09:29:12.202 | INFO     | kliff.calculators.calculator:create:107 - Create calculator for 4 configurations.
    2023-03-28 09:29:12.202 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.203 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.245 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    #================================================================================
    # Model parameters that are optimized.
    # Note that the parameters are in the transformed space if 
    # `params_transform` is provided when instantiating the model.
    #================================================================================

    A 1
      1.5285718915566706e+01 

    lambda 1
      4.5534899728439100e+01 



    '#================================================================================\n# Model parameters that are optimized.\n# Note that the parameters are in the transformed space if \n# `params_transform` is provided when instantiating the model.\n#================================================================================\n\nA 1\n  1.5285718915566706e+01 \n\nlambda 1\n  4.5534899728439100e+01 \n\n'



.. GENERATED FROM PYTHON SOURCE LINES 73-77

To perform UQ by bootstrapping, the general workflow starts by instantiating
:class:`~kliff.uq.bootstrap.BootstrapEmpiricalModel`, or
:class:`~kliff.uq.bootstrap.BootstrapNeuralNetworkModel` if using a neural network
potential.

.. GENERATED FROM PYTHON SOURCE LINES 77-86

.. code-block:: default



    # It is a good practice to specify the random seed to use in the calculation to generate
    # a reproducible simulation.
    np.random.seed(1717)

    # Instantiate bootstrap class object
    BS = BootstrapEmpiricalModel(loss)








.. GENERATED FROM PYTHON SOURCE LINES 87-93

Then, we generate some bootstrap compute arguments. This is equivalent to generating
bootstrap data. Typically, we just need to specify how many bootstrap data samples to
generate. Additionally, if we call ``generate_bootstrap_compute_arguments`` multiple
times, the new generated data samples will be appended to the previously generated data
samples. This is also the behavior if we read the data samples from the previously
exported file.

.. GENERATED FROM PYTHON SOURCE LINES 93-98

.. code-block:: default



    # Generate bootstrap compute arguments
    BS.generate_bootstrap_compute_arguments(100)








.. GENERATED FROM PYTHON SOURCE LINES 99-108

Finally, we will iterate over these bootstrap data samples and train the potential
using each data sample. The resulting optimal parameters from each data sample give a
single sample of parameters. By iterating over all data samples, then we will get an
ensemble of parameters.

We also recommend in using the same optimizer setting as the one used in the model
training step. This also means to use the same set of initial parameter guess when the
loss potentially has multiple local minima. For neural network model, we need to reset
the initial parameter value, which is done internally.

.. GENERATED FROM PYTHON SOURCE LINES 108-113

.. code-block:: default



    # Run bootstrap
    BS.run(min_kwargs=min_kwargs)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2023-03-28 09:29:12.248 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.249 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.289 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.290 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.290 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.330 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.330 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.330 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.366 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.367 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.367 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.409 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.409 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.410 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.445 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.445 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.446 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.480 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.481 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.481 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.515 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.516 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.516 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.561 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.561 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.562 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.596 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.597 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.597 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.631 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.632 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.632 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.667 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.667 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.668 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.704 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.704 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.704 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.741 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.741 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.742 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.779 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.779 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.780 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.816 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.816 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.817 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.857 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.857 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.858 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.898 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.898 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.899 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.938 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.939 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.939 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:12.971 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:12.972 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:12.972 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.014 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.014 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.015 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.057 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.058 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.059 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.097 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.098 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.098 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.125 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.125 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.125 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.152 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.153 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.153 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.188 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.189 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.189 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.224 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.224 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.224 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.260 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.260 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.261 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.296 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.296 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.297 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.331 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.332 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.332 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.373 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.373 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.374 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.413 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.413 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.414 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.451 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.451 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.451 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.490 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.491 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.491 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.528 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.529 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.529 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.568 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.568 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.568 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.605 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.606 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.606 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.650 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.651 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.651 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.685 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.686 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.686 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.723 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.724 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.724 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.754 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.755 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.755 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.790 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.790 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.791 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.830 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.831 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.831 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.866 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.866 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.867 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.901 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.902 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.902 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.938 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.939 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.939 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:13.973 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:13.974 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:13.974 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.011 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.012 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.012 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.049 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.049 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.050 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.088 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.088 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.089 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.129 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.130 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.130 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.169 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.170 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.170 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.207 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.208 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.208 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.236 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.236 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.237 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.274 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.274 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.275 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.313 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.314 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.314 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.355 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.355 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.355 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.400 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.400 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.401 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.440 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.441 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.441 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.480 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.481 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.481 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.517 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.518 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.518 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.553 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.554 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.554 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.597 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.598 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.598 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.626 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.627 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.627 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.664 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.666 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.666 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.704 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.705 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.705 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.740 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.741 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.741 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.777 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.778 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.778 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.813 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.813 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.814 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.853 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.853 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.854 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.890 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.891 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.891 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.928 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.928 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.929 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.959 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.959 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.960 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:14.998 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:14.998 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:14.999 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.033 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.034 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.034 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.072 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.072 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.073 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.108 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.108 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.109 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.142 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.143 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.143 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.179 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.179 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.180 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.215 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.216 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.216 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.251 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.251 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.252 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.288 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.288 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.291 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.326 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.327 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.327 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.354 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.354 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.354 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.389 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.389 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.390 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.425 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.426 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.426 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.463 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.464 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.464 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.506 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.506 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.507 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.544 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.544 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.545 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.580 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.580 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.581 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.617 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.617 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.618 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.652 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.652 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.653 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.687 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.687 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.687 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.722 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.722 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.723 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.760 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.760 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.761 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.796 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.797 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.797 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.830 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.831 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.831 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.859 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.859 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.860 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.893 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.894 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.894 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.929 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.
    2023-03-28 09:29:15.930 | INFO     | kliff.loss:minimize:312 - Start minimization using method: lm.
    2023-03-28 09:29:15.930 | INFO     | kliff.loss:_scipy_optimize:431 - Running in serial mode.
    2023-03-28 09:29:15.964 | INFO     | kliff.loss:minimize:314 - Finish minimization using method: lm.

    array([[15.28616743, 45.53413524],
           [15.28539627, 45.53724361],
           [15.28585555, 45.53650355],
           [15.28603291, 45.53612439],
           [15.28571892, 45.53489973],
           [15.28539627, 45.53724361],
           [15.28570725, 45.5312858 ],
           [15.28584281, 45.532998  ],
           [15.28616881, 45.53755689],
           [15.28559134, 45.53694894],
           [15.28546948, 45.53511245],
           [15.28515489, 45.53371441],
           [15.28584281, 45.532998  ],
           [15.28559028, 45.53312488],
           [15.28578432, 45.53278061],
           [15.28630964, 45.5355221 ],
           [15.28559028, 45.53312488],
           [15.28559028, 45.53312488],
           [15.28571892, 45.53489973],
           [15.28559028, 45.53312488],
           [15.28526585, 45.53538115],
           [15.28590466, 45.53453664],
           [15.28571892, 45.53489973],
           [15.28571892, 45.53489973],
           [15.28551882, 45.53523541],
           [15.28584281, 45.532998  ],
           [15.28603291, 45.53612439],
           [15.28538128, 45.53343707],
           [15.2864703 , 45.53508198],
           [15.28570725, 45.5312858 ],
           [15.28559028, 45.53312488],
           [15.28572139, 45.53860548],
           [15.28515489, 45.53371441],
           [15.28616881, 45.53755689],
           [15.28551882, 45.53523541],
           [15.28526585, 45.53538115],
           [15.28603291, 45.53612439],
           [15.28570725, 45.5312858 ],
           [15.28633634, 45.53370352],
           [15.28571892, 45.53489973],
           [15.28559134, 45.53694894],
           [15.28572139, 45.53860548],
           [15.28590466, 45.53453664],
           [15.28584281, 45.532998  ],
           [15.28526585, 45.53538115],
           [15.28603291, 45.53612439],
           [15.28609088, 45.5304963 ],
           [15.28493205, 45.53767105],
           [15.28546948, 45.53511245],
           [15.28616743, 45.53413524],
           [15.28633634, 45.53370352],
           [15.28526585, 45.53538115],
           [15.28571892, 45.53489973],
           [15.28515489, 45.53371441],
           [15.28578432, 45.53278061],
           [15.28549314, 45.53163801],
           [15.28572139, 45.53860548],
           [15.28559134, 45.53694894],
           [15.28526585, 45.53538115],
           [15.28603291, 45.53612439],
           [15.28590466, 45.53453664],
           [15.28570725, 45.5312858 ],
           [15.28571892, 45.53489973],
           [15.28603275, 45.53259999],
           [15.28598621, 45.53454737],
           [15.28551882, 45.53523541],
           [15.28590466, 45.53453664],
           [15.28598621, 45.53454737],
           [15.28549314, 45.53163801],
           [15.28598621, 45.53454737],
           [15.28539627, 45.53724361],
           [15.28571892, 45.53489973],
           [15.28585555, 45.53650355],
           [15.2864703 , 45.53508198],
           [15.28559028, 45.53312488],
           [15.28603275, 45.53259999],
           [15.28526585, 45.53538115],
           [15.28515489, 45.53371441],
           [15.28551882, 45.53523541],
           [15.28590466, 45.53453664],
           [15.28590466, 45.53453664],
           [15.28603275, 45.53259999],
           [15.28571892, 45.53489973],
           [15.28504553, 45.53561156],
           [15.28559028, 45.53312488],
           [15.28559134, 45.53694894],
           [15.28616743, 45.53413524],
           [15.28481349, 45.53991774],
           [15.28538128, 45.53343707],
           [15.28620979, 45.53217886],
           [15.28538128, 45.53343707],
           [15.28570725, 45.5312858 ],
           [15.28603291, 45.53612439],
           [15.28546948, 45.53511245],
           [15.28559134, 45.53694894],
           [15.2859058 , 45.53090459],
           [15.28571892, 45.53489973],
           [15.28590466, 45.53453664],
           [15.28546948, 45.53511245],
           [15.28493205, 45.53767105]])



.. GENERATED FROM PYTHON SOURCE LINES 114-117

The resulting parameter ensemble can be accessed in `BS.samples` as a `np.ndarray`.
Then, we can plot the distribution of the parameters, as an example, or propagate the
error to the target quantities we want to study.

.. GENERATED FROM PYTHON SOURCE LINES 117-127

.. code-block:: default



    # Plot the distribution of the parameters
    plt.figure()
    plt.plot(*(BS.samples.T), ".", alpha=0.5)
    param_names = list(opt_params.keys())
    plt.xlabel(param_names[0])
    plt.ylabel(param_names[1])
    plt.show()




.. image-sg:: /auto_examples/images/sphx_glr_example_uq_bootstrap_001.png
   :alt: example uq bootstrap
   :srcset: /auto_examples/images/sphx_glr_example_uq_bootstrap_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 128-129

.. _OpenKIM: https://openkim.org


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  5.699 seconds)


.. _sphx_glr_download_auto_examples_example_uq_bootstrap.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_uq_bootstrap.py <example_uq_bootstrap.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_uq_bootstrap.ipynb <example_uq_bootstrap.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
